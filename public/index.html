<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/images/favicon.png" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="GestÃ£o de Pedidos, Produtos, Clientes e Entregas para Bares, Restaurantes, Fast-foods e Delivery's em Geral." />
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/images/favicon.png" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" />
    <title>DeliveryBairro.com | index</title>
    <script src="https://kit.fontawesome.com/939a7fadb5.js" crossorigin="anonymous"></script>
    <script src="//code.jivosite.com/widget/sZlf9WnJ4q" async></script>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="sweetalert2/dist/sweetalert2.min.js"></script>
    <script>
      import Swal from 'sweetalert2/dist/sweetalert2.js';
    </script>

    <link rel="stylesheet" href="./index.css" />
  </head>

  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root">
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    </div>
    <a href="#whatsapp" id="buttomWhatsapp" onclick="formWhatsApp()" class="float">
      <svg class="icon">
        <path d="M.33,48.33,3.06,35.62A23.67,23.67,0,0,1,0,24,24.06,24.06,0,0,1,24.12,0h0a23.95,23.95,0,1,1,0,47.89,24.33,24.33,0,0,1-11-2.61ZM13.7,41.08l.67.36a20.3,20.3,0,0,0,9.74,2.49A20,20,0,1,0,4,24a19.78,19.78,0,0,0,2.89,10.3l.41.68L5.52,43Z" />
        <path d="M34.67,31.75C34.22,33,32,34.21,31,34.31S30,35.12,24.5,33s-9-7.77-9.27-8.13S13,21.92,13,19.27a6.08,6.08,0,0,1,1.89-4.5,2,2,0,0,1,1.45-.67c.36,0,.72.05,1,.05s.77-.18,1.22.9,1.54,3.72,1.67,4a1,1,0,0,1,.05.95,3.53,3.53,0,0,1-.54.89c-.28.32-.58.71-.82.95s-.55.56-.24,1.09a16.48,16.48,0,0,0,3,3.73,14.93,14.93,0,0,0,4.37,2.68c.54.26.86.22,1.17-.14s1.36-1.58,1.72-2.12.72-.45,1.22-.26,3.17,1.47,3.71,1.74.9.41,1,.63A4.4,4.4,0,0,1,34.67,31.75Z" />
      </svg>
    </a>
  </body>

  <script>
    function maskPhoneNumber(value) {
      if(!value) { 
        return '' 
      } else { 
        return value.replace(/[\D]/g, '')
        .replace(/(\d{2})(\d)/, '($1) $2')
        .replace(value[5] !== "9" ? /(\d{4})(\d)/ : /(\d{5})(\d)/, '$1-$2')
        .replace(/(-\d{4})(\d+?)/, '$1')
      }
    }

    function applyPhoneNumberMask(input) {
      input.value = maskPhoneNumber(input.value)
    }

    async function formWhatsApp() {
      const { value: formValues } = await Swal.fire({
        title: 'Contato via WhatsApp',
        html: 
          '<p>Por favor, informe seu Nome e Telefone</p>'+
          '<input id="swal-input1" class="swal2-input" placeholder="Nome" >' +
          '<input id="swal-input2" class="swal2-input" placeholder="Telefone" oninput="applyPhoneNumberMask(this)" >',
        showCancelButton: true,
        cancelButtonText: 'CANCELAR',
        focusConfirm: false,
        preConfirm: () => {
          const FullName = Swal.getPopup().querySelector('#swal-input1').value;
          const TelephoneNumber = Swal.getPopup().querySelector('#swal-input2').value;
          if (!FullName || !TelephoneNumber) {
            Swal.showValidationMessage('Por favor, preencha o Nome e Telefone!');
          }
          return { nome: FullName, telefone: TelephoneNumber };
        }
      }).then(async(result) => {
        if (result.isConfirmed) {
          const nome = result.value.nome;
          const telefone = result.value.telefone;
          // Enviando os dados para o servidor Node.js
          const response = await fetch('http://localhost:3333/send-message', {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({ nome, telefone }),
          });
          if (response.ok) {
            // Redirecione para a API do WhatsApp
            // window.location.href = `https://api.whatsapp.com/send?phone=5531984107540&text=OlÃ¡,+meu+nome+Ã©+${nome},+eu+gostaria+de+fazer+uma+assinatura.+(clique+aqui+p/+enviar)+ðŸ‘‰`;
            window.open(`https://api.whatsapp.com/send?phone=5531984107540&text=OlÃ¡,+meu+nome+Ã©+${nome},+eu+gostaria+de+fazer+uma+assinatura.+(clique+aqui+p/+enviar)+ðŸ‘‰`, _blank);
          }

        } else if (formValues) {
          Swal.fire(JSON.stringify(formValues));
        }
      })
    }
  </script>
</html>